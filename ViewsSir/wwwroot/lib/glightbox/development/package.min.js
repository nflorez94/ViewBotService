/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/glightbox@3.2.0/development/package.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
const fs=require("fs"),os=require("os"),jetpack=require("fs-jetpack"),path=require("path"),archiver=require("archiver"),args=process.argv.slice(2),notify=require("./notifications"),folder=path.join(__dirname,"/..");async function createFolder(){jetpack.remove(path.join(folder,"glightbox-master.zip"));const e=path.join(os.tmpdir(),"glightbox-master"),r=args[0];await updateFileVersion({file:path.join(folder,"index.html"),search:/download\/(.*)\/glightbox/g,replace:r}),await updateFileVersion({file:path.join(folder,"package.json"),search:/"version":\s?"(.*)",/g,replace:r}),await updateFileVersion({file:path.join(folder,"README.md"),search:/v([0-9-.]+)/g,replace:r}),await updateFileVersion({file:path.join(folder,"src/js/glightbox.js"),search:/version\s?=\s?'(.*)';/g,replace:r}),jetpack.copy(folder,e,{matching:["!node_modules","!node_modules/**/*","!.git","!.git/**/*","!.github","!.github/**/*","!.vscode","!.idea","!.idea/**/*","!.nova","!.nova/**/*","!icons.zip","!.vscode/**/*","!*.psd","!.DS_Store"]}),notify("Created folder","Created folder correctly");const a=await createZip(e).catch((r=>{jetpack.remove(e)})),i=path.basename(folder);jetpack.remove(e),jetpack.move(a,path.join(folder,i+"-master.zip")),notify("Done","Packaging process ended correctly")}async function createZip(e){return new Promise(((r,a)=>{const i=e+".zip",t=fs.createWriteStream(i),o=archiver("zip",{zlib:{level:9}});t.on("close",(()=>{notify("Zipped","zip archive was created correctly"),r(i)})),o.on("error",(e=>{notify("Package Error","The was an error creating the zip."),a(e)})),o.pipe(t),o.directory(e,!1),o.finalize()}))}async function updateFileVersion(e){return new Promise(((r,a)=>{jetpack.readAsync(e.file).then((a=>{let i=new RegExp(e.search);for(;null!==(matches=i.exec(a));){let r=matches[0],i=r.replace(matches[1],e.replace);a=a.replace(r,i)}jetpack.writeAsync(e.file,a).then((()=>{r(e.file)}))}))}))}createFolder();
//# sourceMappingURL=/sm/af644e512cd2ee4b020471c9eb14b85810d82e5400e4a9ddd714796f33684f37.map